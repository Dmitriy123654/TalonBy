<div class="profile-page" *ngIf="currentUser">
  <div class="container">
    <div class="profile-header">
      <h1 class="user-email">{{ currentUser.email }}</h1>
      <a href="#" class="settings-link">Настройки аккаунта</a>
    </div>

    <div class="profile-tabs">
      <ul class="tabs">
        <li class="tab" [class.active]="activeTab === 'patients'" (click)="setActiveTab('patients')">
          Пациенты
        </li>
        <li class="tab" [class.active]="activeTab === 'appointments'" (click)="setActiveTab('appointments')">
          Талоны
        </li>
        <li class="tab" [class.active]="activeTab === 'visits'" (click)="setActiveTab('visits')">
          Вызовы врача
        </li>
        <li class="tab" [class.active]="activeTab === 'analyses'" (click)="setActiveTab('analyses')">
          Анализы
        </li>
      </ul>
    </div>

    <div class="profile-content">
      <!-- Пациенты tab content -->
      <div class="patients-section" *ngIf="activeTab === 'patients'">
        <div class="patients-grid">
          <!-- Main user profile card -->
          <div class="patient-card own-profile">
            <div class="card-header">
              <h2>Мой профиль</h2>
            </div>
            <div class="card-body">
              <div class="profile-name">{{ currentUser.fullName }}</div>
              <div class="profile-address">{{ currentUser.address }}</div>
              <div class="profile-birthdate">{{ currentUser.birthDate }}</div>
            </div>
            <div class="card-actions">
              <button class="action-btn edit" (click)="editProfile()">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                  <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                </svg>
              </button>
              <button class="action-btn delete" (click)="deleteProfile()">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <polyline points="3 6 5 6 21 6"></polyline>
                  <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                  <line x1="10" y1="11" x2="10" y2="17"></line>
                  <line x1="14" y1="11" x2="14" y2="17"></line>
                </svg>
              </button>
            </div>
          </div>

          <!-- Add adult patient card -->
          <div class="patient-card add-patient" (click)="addAdultPatient()">
            <div class="add-patient-content">
              <span class="add-patient-text">Добавить пациента (взрослый)</span>
            </div>
          </div>

          <!-- Add child patient card -->
          <div class="patient-card add-patient" (click)="addChildPatient()">
            <div class="add-patient-content">
              <span class="add-patient-text">Добавить пациента (дети)</span>
            </div>
          </div>

          <!-- List of added patients would go here -->
          <div class="patient-card" *ngFor="let patient of currentUser.patients">
            <div class="card-header">
              <h2>{{ patient.relationship }}</h2>
            </div>
            <div class="card-body">
              <div class="profile-name">{{ patient.fullName }}</div>
              <div class="profile-address" *ngIf="patient.address">{{ patient.address }}</div>
              <div class="profile-birthdate">{{ patient.birthDate }}</div>
            </div>
            <div class="card-actions">
              <button class="action-btn edit" (click)="editPatient(patient.patientId)">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                  <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                </svg>
              </button>
              <button class="action-btn delete" (click)="deletePatient(patient.patientId)">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <polyline points="3 6 5 6 21 6"></polyline>
                  <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                  <line x1="10" y1="11" x2="10" y2="17"></line>
                  <line x1="14" y1="11" x2="14" y2="17"></line>
                </svg>
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Other tabs content -->
      <div class="appointments-section" *ngIf="activeTab === 'appointments'">
        <h2>Ваши талоны</h2>
        <p *ngIf="true" class="empty-state">У вас пока нет талонов. Вы можете <a routerLink="/order">записаться на прием</a>.</p>
      </div>

      <div class="visits-section" *ngIf="activeTab === 'visits'">
        <h2>Вызовы врача</h2>
        <p *ngIf="true" class="empty-state">У вас пока нет вызовов врача.</p>
      </div>

      <div class="analyses-section" *ngIf="activeTab === 'analyses'">
        <h2>Анализы</h2>
        <p *ngIf="true" class="empty-state">У вас пока нет анализов.</p>
      </div>
    </div>
  </div>
</div>

<!-- Loading state -->
<div class="loading" *ngIf="!currentUser">
  Загрузка данных...
</div> 